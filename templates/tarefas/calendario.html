{% extends "base.html" %}
{% load dict_filters %}

{% block content %}
<div class="container mt-5" style="max-width: 800px; margin: auto;">
  <h3 class="text-center">{{ mes_nome }} {{ ano }}</h3>

  <table class="table table-bordered text-center align-middle" style="table-layout: fixed; width: 100%;">
    <thead class="table-light">
      <tr>
        <th>Dom</th><th>Seg</th><th>Ter</th><th>Qua</th><th>Qui</th><th>Sex</th><th>Sáb</th>
      </tr>
    </thead>
    <tbody>
      {% for semana in semanas %}
        <tr>
          {% for dia in semana %}
            {% if dia == 0 %}
              <td></td>
            {% else %}
              <td class="align-top" style="min-width:100px; max-width:100px; vertical-align: top; word-wrap: break-word; overflow-wrap: break-word;">
                <strong>{{ dia }}</strong>
                {% if dia in tarefas_por_dia %}
                  <ul class="list-unstyled mt-1 mb-0" style="max-height: 150px; overflow-y: auto; padding-left: 0;">
                    {% for tarefa in tarefas_por_dia|dict_get:dia %}
                      <li style="margin-bottom: 4px;">
                        <span class="badge 
                          {% if tarefa.status == 'pendente' %}bg-warning
                          {% elif tarefa.status == 'em_progresso' %}bg-primary
                          {% elif tarefa.status == 'concluida' %}bg-success
                          {% endif %}" 
                          style="white-space: normal; display: block;">
                          {{ tarefa.titulo }}
                        </span>
                      </li>
                    {% endfor %}
                  </ul>
                {% endif %}
              </td>
            {% endif %}
          {% endfor %}
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="small text-muted mt-3 text-center">
    <span class="badge bg-warning">&nbsp;</span> Pendente &nbsp;
    <span class="badge bg-primary">&nbsp;</span> Em Progresso &nbsp;
    <span class="badge bg-success">&nbsp;</span> Concluída
  </div>
</div>
{% endblock %}
